(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-9982"],{BNNy:function(e,t,n){"use strict";var a=function(e,t,n,a){return{pattern:"string"==typeof e?new RegExp(e,a):e,message:t||"输入格式不匹配",trigger:n||"change"}},i=function(e,t,n,i){return a("^.{"+e+","+t+"}$",n,"change",i)},r=function(e,t,n){return a("^[0-9]{"+e+","+t+"}$",n)},o=function(e,t,n,a){return{validator:function(a,i,r){""===i&&r(),i+="";var o=parseInt(i);i.length===(o+"").length&&e<=o&&o<=t?r():r(new Error(n||$.tpl("请输入{min} ~ {max}范围内的整数",{min:e,max:t})))},trigger:a||"change"}},l=function(e){return $.tpl("限制{size}位字符输入",{size:e})},d=function(e){return $.tpl("仅支持数字输入，限制最大输入{size}位字符，最小为1位字符",{size:e})},s=/^[0-9]{20}$/,c=/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$|^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,u={validator:function(e,t,n){""===t&&n(),s.test(t)?n():c.test(t)?n():n(new Error("IP地址格式不正确"))},trigger:"change"},m=/^((25[0-5]|2[0-4]\d|[01]?\d\d?)($|(?!\.$)\.)){4}$|^((25[0-5]|2[0-4]\d|[01]?\d\d?)($|(?!\.$)\.)){3}\*$|^((25[0-5]|2[0-4]\d|[01]?\d\d?)($|(?!\.$)\.)){2}\*\.((25[0-5]|2[0-4]\d|[01]?\d\d?))$|^((25[0-5]|2[0-4]\d|[01]?\d\d?)($|(?!\.$)\.)){2}\*\.\*$|^((25[0-5]|2[0-4]\d|[01]?\d\d?)($|(?!\.$)\.)){3}((25[0-5]|2[0-4]\d|[01]?\d\d?))\-((25[0-5]|2[0-4]\d|[01]?\d\d?))$/,f={validator:function(e,t,n){""===t&&n();for(var a=t.trim().split(/,|，/),i=0,r=0;r<a.length;r++)m.test(a[r])||i++;i>0?n(new Error("IP格式错误")):n()},trigger:"change"},p=i(1,16,l(16)),v=i(1,18,l(18)),g=i(1,20,l(20)),h=i(1,24,l(24)),b=i(1,25,l(25)),I=i(1,32,l(32)),F=i(1,36,l(36)),y=i(1,40,l(40)),T=i(1,45,l(45)),w=i(1,50,l(50)),S=i(1,64,l(64)),V=i(1,80,l(80)),D=i(1,100,l(100)),x=i(1,128,l(128),"m"),C=i(1,150,l(150)),_=i(1,250,l(250)),A=i(1,1e3,l(1e3)),E=i(1,1500,l(1500)),N=i(1,45,l(45)),k=function(e,t,n,i){return a("^[a-zA-Z0-9/_-]{"+e+","+t+"}$",n,"change",i)}(1,64,"仅允许输入字母、数字、下划线、中线、以及 / 输入，长度范围 1 ~ 64 位"),P=r(1,4,d(4)),j=r(1,5,d(5)),q=r(1,6,d(6)),z=r(1,10,d(10)),R=r(1,11,d(11)),B=r(1,18,d(18)),G=r(1,20,d(20)),O=r(1,24,d(24)),H=r(1,25,d(25)),U=r(1,32,d(32)),M=r(1,36,d(36)),W=r(1,50,d(50)),L=r(1,64,d(64)),K=o(5,20),Z=o(1,99),J=o(1,100),Q=o(0,128),X=o(1,512),Y=o(1,999),ee=o(1,1e3),te=o(1,3e3),ne=o(1,3600),ae=o(1,9999),ie=o(1,99999),re=o(5,60,"可输入5-60中的任何数字"),oe=a("^(([1-9]{1}[0-9]{0,6}))$","可输入1—9999999中的任何数字"),le=a("^(([1-9]{1}[0-9]{0,5}))$","可输入1—999999中的任何数字"),de=a(/^(([^<>()[\]\\.,;:\s@\\"]+(\.[^<>()[\]\\.,;:\s@\\"]+)*)|(\\".+\\"))@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,"邮箱格式不正确"),se=a("^(([1-9]{1}[0-9]{0,3})|10000|0)$","可输入0—10000中的任何数字，0的级别最小，10000的级别最大"),ce=a("^(([1-9]\\d{0,4})|0)(\\.\\d{1,2})?$","支持数字输入，支持小数点后2位，最大支持小数点前4位数字输入，最大9999G"),ue=a("^[^&#\\s一-龥]{1,30}$","支持1 ~ 30位，除了中文、 空格、' & '、 '#' 以外的字符输入"),me=a("^[a-zA-Z0-9_]{1,30}$","密码由数字、字母、下划线组成，长度为1~30位"),fe=a(/^[0-9]{1,20}$/,"请输入1~20位长度的数字"),pe=a(/^\d{13}$|^\d{20}$/,"请输入13或20位长度的数字"),ve=a(/^\d{1,20}$/,"请输入1~20位长度的数字"),ge=a(/^[1-9]\d*$/,"仅支持输入非零整数"),he=a(/^[1-9]\d?$|^100$/,"仅支持输入非零整数, 数字范围1~100"),be=o(0,1e3,"仅支持数字输入，默认为4，不输入数字则不做限制，最大可设1000路"),Ie=a(/^[0-9\\-]{1,20}$/,"电话号码格式不正确,例如 010-82325561, 支持20位输入"),Fe=a(c,"IP地址格式不正确"),ye=o(1,65535,"端口号请输入1到65535的整数"),Te=a("^(([1-9]{1}[0-9]{0,4}))$|^[0-9]{20}$","可输入1—99999中的任何数字，或20位的国标编号"),we=a("^(([1-9]{1}[0-9]{0,4}))$","可输入1—99999中的任何数字"),$e=a("^(([1-9]\\d{0,19})|0)(\\.\\d{1,2})?$","支持20位数字，精确到小数点后俩位"),Se=a("^(([1-9]{1}[0-9]{0,2}))$|^1000$","可输入1—1000中的任何数字"),Ve=a("^([1-9]{1}[0-9]{0,2})$|^([1-2]{1})([0-9]{0,3})$|^3000$","可输入1—3000中的任何数字"),De=a("^-?(?:(?:180(?:\\.0{1,16})?)|(?:(?:(?:1[0-7]\\d)|(?:[1-9]?\\d))(?:\\.\\d{1,16})?))$","经度范围：-180~180，精确到小数点后16位"),xe=a("^-?(?:90(?:\\.0{1,16})?|(?:[1-8]?\\d(?:\\.\\d{1,16})?))$","纬度范围：-90~90，精确到小数点后16位"),Ce=a("^(([1-9]{1}[0-9]{0,3}))$","可输入1—9999中的任何数字"),_e=a("^(([1-9]\\d{0,9})|0)(\\.\\d{1,2})?$","支持10位数字，精确到小数点后俩位"),Ae=a("^([1-9]\\d{0,4})?$","最大支持5位数字输入"),Ee=a("^([1-9]\\d{0,7})?$","最大支持8位数字输入"),Ne=a("^([0-9a-fA-F]{2}[:-]){5}([0-9a-fA-F]{2})$","MAC地址格式不正确,格式如: 00:A3:19:EF:E4:24"),ke=a(function(){var e="http, https, ftp".split(",").join("|").replace(/\s/g,"");return new RegExp("^(?:(?:"+e+")://)?(?:\\S+(?::\\S*)?@)?(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-?)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-?)*[a-z\\u00a1-\\uffff0-9])*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))?)(?::\\d{2,5})?(?:/[^\\s]*)?$","i")}()),Pe={validator:function(e,t,n){""===t&&n();var a,i=function(){return n(new Error("身份证号填写错误, 请重新填写"))};if(t=t.trim(),/^\d{15}$/.test(t)||/^\d{17}[\dXx]{1}$/.test(t)||i(),a=18===t.length?t.substr(6,8):"19"+t.substr(6,6),function(e,t,n,a){if(isNaN(e)||isNaN(t)||isNaN(n))return!1;if(n.length>2||t.length>2||e.length>4)return!1;if(n=parseInt(n,10),t=parseInt(t,10),(e=parseInt(e,10))<1e3||e>9999||t<=0||t>12)return!1;var i=[31,28,31,30,31,30,31,31,30,31,30,31];if((e%400==0||e%100!=0&&e%4==0)&&(i[1]=29),n<=0||n>i[t-1])return!1;if(!0===a){var r=new Date,o=r.getFullYear(),l=r.getMonth(),d=r.getDate();return e<o||e===o&&t-1<l||e===o&&t-1===l&&n<d}return!0}(parseInt(a.substr(0,4),10),parseInt(a.substr(4,2),10),parseInt(a.substr(6,2),10))||i(),18===t.length){for(var r=0,o=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],l=0;l<17;l++)r+=parseInt(t.charAt(l),10)*o[l];r=(12-r%11)%11,("X"!==t.charAt(17).toUpperCase()?parseInt(t.charAt(17),10):10)===r?n():i()}n()},trigger:"change"},je=function(e,t,n,a){return n=n||"支持"+e+"~"+t+"位的中文、英文（大小写）、整数、下划线、中线、/、. 、空格等输入",{validator:function(a,i,r){void 0!=i&&""!=i||r(),new RegExp("^[a-zA-Z0-9_-/.sΑ-￥]{"+e+","+t+"}$").test(i)||r(new Error(n)),r()},trigger:a||"change"}},qe=je(1,30),ze=je(1,64);t.a={required:function(e,t){return{validator:function(t,n,a){$.isArray(n)?0===n.length?a(new Error(e||"此处为必填项")):a():""===n||void 0===n?a(new Error(e||"此处为必填项")):a()},required:!0,trigger:t||"change"}}(),account64:k,str16:p,str18:v,str20:g,str24:h,str25:b,str32:I,str36:F,str40:y,str45:T,str50:w,str64:S,str80:V,str100:D,str128:x,str150:C,str250:_,str1000:A,str1500:E,strDefault:N,isInt:ge,int4:P,int5:j,int6:q,int10:z,int11:R,int18:B,int20:G,int24:O,int25:H,int32:U,int36:M,int50:W,int64:L,int1_100:he,num:o,num20:K,num99:Z,num128:Q,num100:J,num512:X,num999:Y,num1000:ee,num3000:te,num3600:ne,num9999:ae,num99999:ie,name:je,name30:qe,name64:ze,level:se,gbId:fe,gbId2:pe,civilCode:ve,chanNo:Te,id:Pe,ip:Fe,multiIp:f,ip4gb:u,port:ye,email:de,maxWay:be,latitude:xe,longitude:De,password:ue,password2:me,gbIdStep:Se,gbIdTimes:Ve,serviceSize:$e,cloudPersize:ce,extraChannelNo:we,presetPositions:Ce,deviceInfoPrice:_e,vodInCount6:Ae,trunkInCount6:Ae,platformNum:Ee,isNum:{type:"number",message:"必须为数字值"},macAddr:Ne,phone:Ie,uri:ke,ptzIdleTime:re,projectNumber:oe,nodeNumber:le,remote:function(e){var t=e.id,n=e.name,a=e.api,i=e.apiPrefix,r=e.msg;return{validator:function(e,o,l){if(""===o)l();else{var d={};d[n]=o,t&&(d.id=t),Service[a](d,i).then(function(e){e.data.status?l(new Error(r||e.data.message)):l()},function(e){l(new Error(e.data.message))})}},trigger:"blur"}}}},Gd76:function(e,t){e.exports=function(e,t,n){var a=new Blob([e],{type:n||"application/octet-stream"});if(void 0!==window.navigator.msSaveBlob)window.navigator.msSaveBlob(a,t);else{var i=window.URL.createObjectURL(a),r=document.createElement("a");r.style.display="none",r.href=i,r.setAttribute("download",t),void 0===r.download&&r.setAttribute("target","_blank"),document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(i)}}},HpZk:function(e,t,n){},"I+Ds":function(e,t,n){"use strict";t.a={data:function(){return{model:{},inline:!1,loading:!1}},props:{title:String},computed:{dialog:function(){return this.find("dialog")},renderInit:function(){return window.formFactoryRender.bind(this,this.fields,{})}},methods:{start:function(e){this.loading=!0,$.fire(e)},end:function(e){var t=this;$.fire(e),setTimeout(function(){t.loading=!1},200)},find:function(e){return $.ref.call(this,e)},closest:function(e){return $.pref.call(this,e)},getForm:function(){return this.$refs.formFactory.$refs.form},validate:function(e,t,n){var a=this;try{this.getForm().validate(function(n,i){if(!n)return t&&t.call(a,i),!1;e&&e.call(a)},n)}catch(e){console.log(e)}},submit:function(e){this.validate(this.saveAjax)},resetForm:function(e){this.getForm().resetFields(e||this.defModel)},close:function(){this.dialog.close(),this.tab&&(this.tab="first")}}}},NIpz:function(e,t,n){"use strict";n.r(t);var a=n("P2sY"),i=n.n(a),r=n("kKWf"),o={default:"deviceType,name,ip,gbId",Server:"deviceSubType,name,ip,port,driverId,gbId",Camera:"deviceSubType,accessType,name,ip,channelNo,driverInfo,port,gbId,audio",Encoder:"name,ip,channelNum,driverInfo,port,username,gbId",Decoder:"name,ip,channelNum,maxWindow,driverInfo,port,username,gbId",Keyboard:"name,ip,port,username,driverInfo,gbId"};function l(e){var t=function(e){return{accessType:{name:"接入方式",sortable:!0,minWidth:110,format:function(e){return $.v2str("accessType",e)}},deviceType:{name:"设备类型",sortable:!0,format:function(e){return'<i class="icon icon-'+e+'"></i>'+$.v2str("deviceType",e)}},deviceSubType:{name:"设备类型",minWidth:120,sortable:!0,format:function(t){return"Camera"==e?'<i class="icon icon-Camera-'+t+'" style=""></i>'+$.v2str("cameraType",t):"Server"==e?'<i class="icon icon-server"></i>'+$.v2str("deviceType",t):$.v2str("deviceType",t)}},driverInfo:{name:"驱动类型",format:function(e){return Util.isEmptyFn(e)?"--":e}},name:{name:"设备名称",minWidth:120,sortable:!0},ip:{name:"设备IP",minWidth:120},port:{name:"端口号",format:function(e){return Util.isEmptyFn(e)?"--":e}},mappingId:{name:"映射ID"},channelNo:{name:"通道号"},zoneName:{name:"分区名称"},channelNum:{name:"通道总数"},maxWindow:{name:"单通道最大画面数"},username:{name:"用户名"},password:{name:"密码"},gbId:{name:"国标编号",format:function(e){return Util.isEmptyFn(e)?"--":e}},audio:{name:"拾音器",format:function(e){return'<i class="icon icon-'+(1==e?"selected":"unselected")+'"></i>'}}}}(e),n=[{type:"index",name:"序号",width:"50",minWidth:"50"}];return(o[e]||o.default).split(",").forEach(function(e){for(var a in t)if(a==e){n.push(i()({},{key:a},t[a]));break}}),n}var d=n("QbLZ"),s=n.n(d),c=n("4d7F"),u=n.n(c),m=n("I+Ds"),f={props:{title:String},data:function(){return{driverHT:{}}},computed:{activeNode:function(){return this.$parent.jtree.getActive()},jtree:function(){return this.closest("jtree")},jtable:function(){return this.closest("jtable")}},methods:{setDriverHT:function(e){var t=this;this.driverHT={},e.map(function(e){t.driverHT[e.id]=e})},open:function(e){var t=this;this.model=this.defModel=$.extend(!0,{},$.modelTpl(this.fields,this.option)),this.dialog.open(function(){t.setData(e,function(e){var n={id:e.id};n.id?$.copyValue(n,e,t.fields):n=$.modelTpl(t.fields,t.option,{}),t.model=$.extend(!0,{},n),t.dialog.end()})})},saveAjax:function(){var e=this;this.start(function(){var t=e.getFormValue();$.persist(t,"addDevice","editDevice").then(function(t){e.nvMsg(),e.close(),e.jtree.init().then(function(){return e.$parent.refreshFn()})}).finally(e.end)})},getFormValue:function(){var e=this,t=this.fields,n={id:this.data.id,deviceType:this.data.deviceType,siteId:this.data.siteId};t.forEach(function(t){if(t.name&&(!t.show||t.show())){var a=e.model[t.name];switch(t.name){case"driverId":case"recordDriverId":n[t.name]=a[a.length-1];break;case"zoneId":var i=a[a.length-1];n[t.name]=-1==i?"":i;break;default:n[t.name]=a}}});var a={};return this.isShowGBTab&&(a=this.getSecondFormValue(this.model)),i()(n,a),n}}},p=n("uV9B"),v=n("BNNy");function g(e){return e.map(function(e){var t={};e.devices.forEach(function(e){t[e.type]=e.count});var n=$.db.getConsts().deviceType.map(function(n){return i()({},n,{count:t[n.id]||0,key:function(e,t){return $.isEmptyFn(t.parentId)?[e.siteId,t.id].join("-"):[e.siteId,t.parentId,t.id].join("-")}(e,n),nodeType:"device",icon:function(e){if(!$.isEmptyFn(e.parentId)){var t=e.parentId;if("Server"==t)return t;if("Camera"==t)return[t,e.id].join("-")}return e.id}(n)})});return i()({},e,{key:e.siteId,name:e.siteName,icon:e.siteType,nodeType:"site",children:$.array2tree(n,"id","parentId")})})}function h(e){var t={id:e?e.id:""},n="";if(e)n=e.deviceType,i()(t,{siteId:e.siteId,deviceType:e.deviceType,deviceSubType:e.deviceSubType||""});else{var a=this.jtree.getActive().key.split("-");n=a[1],i()(t,{siteId:a[0],deviceType:a[1],deviceSubType:a[2]||("Camera"==n?"1":"")})}switch(n){case"Camera":t=i()({},t,{accessType:"dv"});break;default:t=i()({},t)}this.$refs[n+"Form"].open(t)}function b(e,t,n){function a(t,n){for(var a=0;a<t.length;a++)if(t[a][e]==n)return!0;return!1}for(var r=[],o=0;o<n.length;o++){var l=n[o];a(r,l[t])||r.push(i()({},l,{virId:l[t],text:l[t]}))}for(var d=0;d<r.length;d++)for(var s=r[d],c=0;c<n.length;c++){var u=n[c];s[t]==u[e]&&(s.children?s.children.push(i()({},u,{virId:u.id,text:u.style,parent:s})):s.children=[i()({},u,{virId:u.id,text:u.style,parent:s})])}return r}var I="change";function F(e,t,n){return{validator:function(t,n,a){if(0==n.length)a();else{var i=function e(t,n){if(n)for(var a=0;a<t.length;a++){var i=t[a];if(i.virId==n)return i;i.children&&e(i.children,n)}}(e,n[n.length-1]);i&&i.children?a(new Error("请选择最底层节点")):a()}},trigger:n||I}}function y(e){return["VideoAnalysis","VideoDiagnose","CloudStorage","VideoPlatform"].indexOf(e)>-1}var T=function(e,t,n,a){return{validator:function(e,n,i){a&&(""===n||void 0===n)?i(new Error(t||"此处为必填项")):i()},required:function(){return a},trigger:n||"change"}},w=n("PoBe"),S={name:"EditForm",mixins:[m.a,f,p.a],data:function(){return{tab:"first",defaultPorts:{TNM:2031,TVS:2011,TVR:6936,TFS:2020,KBS:2015,SuperiorGB:5060},specialServerType:["VideoAnalysis","VideoDiagnose","CloudStorage","VideoPlatform"],gbDataset:["TVR","TFS","VideoAnalysis","VideoDiagnose","SuperiorGB","SubordinateGB"],option:{driverId:[]}}},computed:{fields:function(){return $.formatFinal(function(e){return[{tag:"el-select",name:"deviceSubType",default:"TNM",label:"服务器类型",rules:[v.a.required],data:{props:{disabled:e.activeNode&&"Server"!==e.activeNode.id||!$.isEmptyFn(e.model.id)}},change:function(t){e.model.deviceSubType=t,e.listDriver(),e.model.port=e.defaultPorts[t]?e.defaultPorts[t]:""},createFunction:"formItem"},{tag:"el-input",name:"name",label:"服务器名称",rules:[v.a.required,v.a.str64],createFunction:"formItem"},{tag:"el-input",name:"ip",label:"IP地址",rules:[T(e.model,null,null,!(["SubordinateGB"].indexOf(e.model.deviceSubType)>-1)),v.a.ip],createFunction:"formItem"},{tag:"el-input",name:"channelNum",label:"通道数",show:function(){return"VideoPlatform"==e.model.deviceSubType},rules:[T(e.model,null,null,"VideoPlatform"==e.model.deviceSubType),v.a.num99999],children:[{tag:"template",data:{slot:"append"},children:["个"]}],createFunction:"formItem"},{tag:"el-cascader",name:"driverId",label:"驱动类型",show:function(){return y(e.model.deviceSubType)},tip:"添加设备时，此值改变，用户名、密码、端口号会自动填充默认值",change:function(t){if(2==t.length){var n=e.driverHT[t[1]],a=n.port,i=n.username,r=n.password;e.model.port=a,e.model.username=i,e.model.password=r}},rules:[F(e.option.driverId?e.option.driverId.list:[])],createFunction:"formItem"},{tag:"el-input",name:"port",label:"端口号",tip:"选填项，请输入1 ~ 65535范围内的整数",rules:[v.a.port],createFunction:"formItem"},{tag:"el-input",name:"httpPort",label:"web服务端口号",default:"8080",show:function(){return"TVS"==e.model.deviceSubType},rules:[v.a.port],createFunction:"formItem"},{tag:"el-input",name:"username",label:"用户名",rules:[v.a.str64],show:function(){return y(e.model.deviceSubType)},createFunction:"formItem"},{tag:"el-input",name:"password",label:"密码",tip:"选填，密码由数字、字母、下划线组成，长度为1~30位",rules:[v.a.password],show:function(){return y(e.model.deviceSubType)},createFunction:"formItem"},{tag:"el-input",type:"textarea",name:"deviceParam",label:"设备参数",rules:[v.a.str1000],createFunction:"formItem"}]}(this),null,this.option,!1)},gbFields:function(){return $.formatFinal(function(e){return[{tag:"el-input",name:"gbId",label:"国标编号",tip:"必填，请输入13或20位长度的数字",rules:[v.a.required,v.a.gbId2],createFunction:"formItem"},{tag:"el-input",name:"gbName",label:"名称",rules:[v.a.str64],createFunction:"formItem"},{tag:"el-input",name:"gbPassword",label:"密码",rules:[v.a.password],createFunction:"formItem"},{tag:"el-switch",name:"keepAlive",label:"是否检测心跳",default:1,data:{props:{activeValue:1,inactiveValue:0}},createFunction:"formItem"},{tag:"el-input",name:"interval",label:"心跳间隔时间",default:"15",rules:[v.a.num3600],show:function(){return 1==e.model.keepAlive},children:[{tag:"template",data:{slot:"append"},children:["秒"]}],createFunction:"formItem"},{tag:"el-input",name:"times",label:"心跳检测次数",default:"3",rules:[v.a.num100],show:function(){return 1==e.model.keepAlive},children:[{tag:"template",data:{slot:"append"},children:["次"]}],createFunction:"formItem"},{tag:"el-switch",name:"auth",label:"是否鉴权",default:1,data:{props:{activeValue:1,inactiveValue:0}},createFunction:"formItem"},{tag:"el-switch",name:"adjustTime",label:"是否校时",default:1,data:{props:{activeValue:1,inactiveValue:0}},createFunction:"formItem"},{tag:"el-input",name:"period",label:"注册有效期",default:"30",rules:[v.a.num1000],show:function(){return["VideoAnalysis","VideoDiagnose","SuperiorGB"].indexOf(e.model.deviceSubType)>-1},children:[{tag:"template",data:{slot:"append"},children:["天"]}],createFunction:"formItem"},{tag:"el-select",name:"safetyWay",label:"信令安全模式",default:"0",show:function(){return["VideoAnalysis","VideoDiagnose","SuperiorGB"].indexOf(e.model.deviceSubType)>-1},createFunction:"formItem"},{tag:"el-select",name:"registerWay",label:"注册方式",show:function(){return["VideoAnalysis","VideoDiagnose","SuperiorGB"].indexOf(e.model.deviceSubType)>-1},createFunction:"formItem"},{tag:"el-input",name:"rtpSendPort",label:"RTP发送端口",rules:[v.a.port],show:function(){return"TFS"==e.model.deviceSubType},default:"16000",createFunction:"formItem"},{tag:"el-input",name:"recvIp",label:"数据接受IP",rules:[v.a.ip],show:function(){return"TFS"==e.model.deviceSubType},createFunction:"formItem"},{tag:"el-input",name:"sendIp",label:"数据发送IP",rules:[v.a.ip],show:function(){return"TFS"==e.model.deviceSubType},createFunction:"formItem"},{tag:"el-switch",name:"use",label:"是否启用",default:1,data:{props:{activeValue:1,inactiveValue:0}},show:function(){return["VideoAnalysis","VideoDiagnose","TFS","SuperiorGB"].indexOf(e.model.deviceSubType)>-1},createFunction:"formItem"},{tag:"el-switch",name:"tcp",label:"是否采用TCP",default:1,data:{props:{activeValue:1,inactiveValue:0,activeText:"开",inactiveText:"关"}},show:function(){return["VideoAnalysis","VideoDiagnose","SuperiorGB"].indexOf(e.model.deviceSubType)>-1},createFunction:"formItem"},{tag:"el-input",name:"number",label:"每次传送数量",default:"1000",rules:[v.a.num99999],show:function(){return["VideoAnalysis","VideoDiagnose","SuperiorGB"].indexOf(e.model.deviceSubType)>-1},createFunction:"formItem"},{tag:"el-switch",name:"alwaysTrans",label:"是否强制转码",default:1,data:{props:{activeValue:1,inactiveValue:0}},show:function(){return"TFS"==e.model.deviceSubType},createFunction:"formItem"},{tag:"el-switch",name:"streamReuse",label:"是否流复用",default:1,data:{props:{activeValue:1,inactiveValue:0}},show:function(){return"TFS"==e.model.deviceSubType},createFunction:"formItem"},{tag:"el-switch",name:"extractEnable",label:"是否加速转码",default:1,data:{props:{activeValue:1,inactiveValue:0}},show:function(){return"TFS"==e.model.deviceSubType},createFunction:"formItem"},{tag:"el-switch",name:"gpuEnable",label:"是否采用GPU编码",default:1,data:{props:{activeValue:1,inactiveValue:0}},show:function(){return"TFS"==e.model.deviceSubType},createFunction:"formItem"},{tag:"el-switch",name:"rtcpEnable",label:"是否开启RTCP",default:1,data:{props:{activeValue:1,inactiveValue:0}},show:function(){return"TFS"==e.model.deviceSubType},createFunction:"formItem"},{tag:"el-switch",name:"rtcpUpEnable",label:"是否检测上级RTCP",default:1,data:{props:{activeValue:1,inactiveValue:0}},show:function(){return"TFS"==e.model.deviceSubType&&1==e.model.rtcpEnable},createFunction:"formItem"},{tag:"el-switch",name:"rtcpDownEnale",label:"是否检测下级RTCP",default:1,data:{props:{activeValue:1,inactiveValue:0}},show:function(){return"TFS"==e.model.deviceSubType&&1==e.model.rtcpEnable},createFunction:"formItem"},{tag:"el-input",name:"rtcpSendCycle",label:"rtcp 发送间隔时间",default:"10",rules:[v.a.num3600],show:function(){return"TFS"==e.model.deviceSubType&&1==e.model.rtcpEnable},children:[{tag:"template",data:{slot:"append"},children:["秒"]}],createFunction:"formItem"},{tag:"el-input",name:"rtcpRecvTimeout",label:"rtcp 接受超时时间",default:"20",rules:[v.a.num3600],show:function(){return"TFS"==e.model.deviceSubType&&1==e.model.rtcpEnable},children:[{tag:"template",data:{slot:"append"},children:["秒"]}],createFunction:"formItem"}]}(this),w.a.gb,this.gbOption,!1)},renderInit:function(){return window.formFactoryRender.bind(this,this.fields,{})},renderGBInit:function(){return window.formFactoryRender.bind(this,this.gbFields,{})},isShowGBTab:function(){return this.gbDataset.indexOf(this.model.deviceSubType)>-1}},methods:{setData:function(e,t){var n=this,a=this;$.initForm({model:e,ajax:[[Service.listDevice4Type,{id:e.id},"put"],[Service.listDriver,{driverType:e.deviceSubType},"put"]],events:[function(e){var t=$.db.getConsts();a.option={deviceSubType:{default:"",name:"name",value:"id",list:t.serverType||[]},driverId:{default:"",name:"text",value:"virId",list:[]}}},{method:"put",fn:function(e){a.data=e[0].data,a.option=i()({},n.option,{driverId:{name:"name",value:"id",list:b("provider","provider",e[1].items||[])}})}},{method:"post",fn:function(t){a.data=e}},function(){$.fire(t,a.data)}]})},listDriver:function(e){var t=this;return new u.a(function(n){Service.listDriver(e||{driverType:t.model.deviceSubType}).then(function(e){t.option=i()({},t.option,{driverId:{name:"text",value:"virId",list:b("provider","provider",e.items||[])}}),t.setDriverHT(e.items),n()})})},open:function(e){var t=this;this.model=this.defModel=$.extend(!0,$.modelTpl(this.fields),{driverId:[]}),this.dialog.open(function(){t.setData(e,function(n){var a=s()({id:n.id},e),i={};if(a.id){if("gb28181"in n){var r=Util.isEmptyFn(n.gb28181)?{}:JSON.parse(n.gb28181);$.copyValue(i,r,t.gbFields)}$.copyValue(a,n,t.fields)}else $.modelTpl(t.fields,t.option);t.specialServerType.indexOf(a.deviceSubType)>-1?t.listDriver({driverType:a.deviceSubType}).then(function(){var e=t.option.driverId.list;a.driverId=$.createCascadeValue(a.id?n.driverId:"",e,"virId"),!a.id&&a.deviceSubType&&(a.port=t.defaultPorts[a.deviceSubType]?t.defaultPorts[a.deviceSubType]:""),t.model=$.extend(!0,{},a,i),t.dialog.end()}):(a.driverId=[],!a.id&&a.deviceSubType&&(a.port=t.defaultPorts[a.deviceSubType]?t.defaultPorts[a.deviceSubType]:""),t.model=$.extend(!0,{},a,i),t.dialog.end())})})}}},V=n("KHd+"),D=Object(V.a)(S,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("nv-dialog",{ref:"dialog",staticClass:"tab-dialog",attrs:{title:e.title},on:{close:e.closeEvent}},[n("div",{staticClass:"form-content"},[n("el-tabs",{attrs:{type:"border-card"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[n("el-tab-pane",{attrs:{label:"基础配置",name:"first"}},[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"icon icon-basic"}),e._v(" 基础配置")]),e._v(" "),n("form-factory",{ref:"formFactory",attrs:{init:e.renderInit}})],1),e._v(" "),e.isShowGBTab?n("el-tab-pane",{attrs:{label:"国标配置",name:"second"}},[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"icon icon-gb"}),e._v(" 国标配置")]),e._v(" "),n("form-factory",{ref:"gbFormFactory",attrs:{init:e.renderGBInit}})],1):e._e()],1),e._v(" "),n("div",{staticClass:"btns"},[n("el-button",{attrs:{loading:e.loading,size:"mini",type:"primary"},on:{click:e.submit}},[e._v("确定")]),e._v(" "),n("el-button",{attrs:{size:"mini"},on:{click:e.close}},[e._v("取消")])],1)],1)])},[],!1,null,null,null);D.options.__file="dialog.vue";var x=D.exports,C=function(e){return[{tag:"el-select",name:"accessType",label:"摄像机接入方式",rules:[v.a.required],data:{props:{disabled:!!e.model.id}},change:function(t){e.model.accessType=t,this.model.encoderId="",this.model.channelNo="",e.getNotRelatedDevices()},createFunction:"formItem"},{tag:"el-input",name:"name",label:"摄像机名称",rules:[v.a.required,v.a.str64],createFunction:"formItem"},{tag:"el-select",name:"deviceSubType",label:"摄像机类型",default:"1",rules:[v.a.required],data:{props:{disabled:e.activeNode&&"Camera"!==e.activeNode.id}},createFunction:"formItem"},{tag:"el-select",name:"encoderId",label:"关联编码器（平台）ID",tip:"请先选择关联编码器（平台）ID，再选择通道编号",rules:[v.a.required],change:function(t){e.model.encoderId=t,e.model.channelNo="",e.setChannelNoList()},show:function(){return"dv"!=e.model.accessType},createFunction:"formItem"},{tag:"el-select",name:"channelNo",label:"通道号",rules:[v.a.required],data:{props:{disabled:"dv"==e.model.accessType}},createFunction:"formItem"},{tag:"el-input",name:"ip",label:"IP地址",rules:[v.a.required,v.a.ip],show:function(){return"dv"==e.model.accessType},createFunction:"formItem"},{tag:"el-cascader",name:"driverId",label:"驱动类型",tip:"添加设备时，此值改变，用户名、密码、端口号会自动填充默认值",rules:[function(e,t,n){return{validator:function(n,a,i){"dv"!==e.accessType||""!==a&&void 0!==a?i():i(new Error(t||"此处为必填项"))},required:function(){return"dv"==e.accessType},trigger:n||"change"}}(e.model),F(e.option.driverId?e.option.driverId.list:[])],change:function(t){if(2==t.length){var n=e.driverHT[t[1]],a=n.port,i=n.username,r=n.password;e.model.port=a,e.model.username=i,e.model.password=r}},show:function(){return"dv"==e.model.accessType},createFunction:"formItem"},{tag:"el-input",name:"port",label:"端口号",tip:"必填项，请输入1 ~ 65535范围内的整数",rules:[v.a.required,v.a.port],show:function(){return"dv"==e.model.accessType},createFunction:"formItem"},{tag:"el-input",name:"username",label:"用户名",show:function(){return"dv"==e.model.accessType},rules:[v.a.required,v.a.str64],createFunction:"formItem"},{tag:"el-input",name:"password",label:"密码",show:function(){return"dv"==e.model.accessType},rules:[v.a.password],createFunction:"formItem"},{tag:"el-input",name:"mappingId",label:"编号",tip:["此标识用于键盘上墙的映射ID，需保证节点内唯一"],rules:[v.a.str20],createFunction:"formItem"},{tag:"el-switch",name:"audio",label:"接入拾音器",default:0,data:{props:{activeValue:1,inactiveValue:0}},createFunction:"formItem"},{tag:"el-cascader",name:"zoneId",label:"所属分区",createFunction:"formItem",data:{props:{clearable:!0}},rules:[{validator:function(e,t,n){t[0],n()}}]},{tag:"el-input",name:"channelParam",label:"通道参数",rules:[v.a.str128],createFunction:"formItem"},{tag:"el-input",name:"channelAddr",label:"通道地址",show:function(){return"dv"!=e.model.accessType},rules:[v.a.str64],createFunction:"formItem"},{tag:"el-input",type:"textarea",name:"deviceParam",label:"设备参数",rules:[v.a.str1000],createFunction:"formItem"},{tag:"el-input",name:"multicastIp",label:"组播IP",tip:"选填项，遵循IPv4规范",rules:[v.a.ip],createFunction:"formItem"},{tag:"el-input",name:"multicastPort",label:"组播端口",tip:"选填项，请输入1 ~ 65535范围内的整数",rules:[v.a.port],createFunction:"formItem"},{tag:"el-cascader",name:"recordDriverId",label:"录像驱动类型",show:function(){return"dv"==e.model.accessType},rules:[F(e.option.recordDriverId?e.option.recordDriverId.list:[])],createFunction:"formItem"},{tag:"el-switch",name:"share",label:"是否共享上级",default:1,data:{props:{activeValue:1,inactiveValue:0}},createFunction:"formItem"}]},_={name:"EditForm",mixins:[m.a,f,p.a],data:function(){return{tab:"first",isShowGBTab:!0,model:{},defModel:{},loading:!1,encoderHT:new $.IListManager,driverHT:{},option:{driverId:[],zoneId:[],recordDriverId:[]},gbOption:{}}},computed:{fields:function(){return $.formatFinal(C(this),$.db.getFinal(),this.option,!1)},gbFields:function(){return $.formatFinal(function(e){return[{tag:"el-input",name:"gbId",label:"国标编号",tip:"必填, 允许输入13或20位长度的数字",rules:[v.a.required,v.a.gbId2],createFunction:"formItem"},{tag:"el-input",name:"gbName",label:"名称",rules:[v.a.str64],createFunction:"formItem"},{tag:"el-input",name:"civil",label:"行政区划编号",tip:"必填项, 允许输入1~20位长度的数字",rules:[v.a.required,v.a.civilCode],createFunction:"formItem"},{tag:"el-select",name:"registerWay",label:"注册方式",default:"1",rules:[v.a.required],createFunction:"formItem"},{tag:"el-input",name:"manufacture",label:"设备厂商",rules:[v.a.str64],createFunction:"formItem"},{tag:"el-input",name:"model",label:"设备型号",rules:[v.a.str64],createFunction:"formItem"},{tag:"el-input",name:"owner",label:"设备归属",tips:["建议填写业主名称"],rules:[v.a.str64],createFunction:"formItem"},{tag:"el-input",name:"certnum",label:"证书序列号",rules:[v.a.str64],createFunction:"formItem"},{tag:"el-select",name:"certifiable",label:"证书有效标识",default:"1",createFunction:"formItem"},{tag:"el-input",name:"errCode",label:"证书无效原因码",rules:[v.a.str64],createFunction:"formItem"},{tag:"el-date-picker",type:"datetime",name:"endTime",label:"证书终止有效期",createFunction:"formItem"},{tag:"el-select",name:"secrecy",label:"保密属性",default:"0",createFunction:"formItem"},{tag:"el-input",name:"gbIp",label:"设备IP",rules:[v.a.ip],createFunction:"formItem"},{tag:"el-input",name:"gbPort",label:"设备端口",rules:[v.a.port],createFunction:"formItem"},{tag:"el-input",name:"gbPassword",label:"设备口令",rules:[v.a.str64],createFunction:"formItem"},{tag:"el-select",name:"safetyWay",label:"信令安全模式",default:"0",createFunction:"formItem"},{tag:"el-input",name:"longitude",label:"经度",tip:"选填，输入-180-180，最大精确到小数点后16位，摄像机经度位置",rules:[v.a.longitude],createFunction:"formItem"},{tag:"el-input",name:"latitude",label:"纬度",tip:"选填，输入-90-90，最大精确到小数点后16位，摄像机纬度位置",rules:[v.a.latitude],createFunction:"formItem"},{tag:"el-select",name:"ptz",label:"摄像机类型",createFunction:"formItem"},{tag:"el-input",name:"address",label:"安装地址",rules:[v.a.str64],createFunction:"formItem"},{tag:"el-select",name:"parental",label:"是否有子设备",default:"0",createFunction:"formItem"},{tag:"el-select",name:"position",label:"位置类型",createFunction:"formItem"},{tag:"el-select",name:"room",label:"安装位置",default:"1",createFunction:"formItem"},{tag:"el-select",name:"use",label:"摄像机用途",default:"1",createFunction:"formItem"},{tag:"el-input",name:"block",label:"警区",rules:[v.a.str64],createFunction:"formItem"},{tag:"el-select",name:"supplyLight",label:"摄像机补光",default:"1",createFunction:"formItem"},{tag:"el-select",name:"direction",label:"监视方位",default:"1",createFunction:"formItem"},{tag:"el-select",name:"resolution",label:"摄像机分辨率",default:"1",createFunction:"formItem"},{tag:"el-input",name:"businessGroup",label:"业务分组ID",rules:[v.a.int20],createFunction:"formItem"},{tag:"el-input",name:"multicastIp",label:"组播IP",rules:[v.a.ip],createFunction:"formItem"},{tag:"el-input",name:"multicastPort",label:"组播端口",rules:[v.a.port],createFunction:"formItem"},{tag:"el-switch",name:"keepAlive",label:"是否检测心跳",default:1,data:{props:{activeValue:1,inactiveValue:0}},createFunction:"formItem"},{tag:"el-input",name:"interval",label:"心跳间隔时间",default:"15",show:function(){return 1==e.model.keepAlive},rules:[v.a.num3600],children:[{tag:"template",data:{slot:"append"},children:["秒"]}],createFunction:"formItem"},{tag:"el-input",name:"times",label:"心跳检测次数",default:"3",rules:[v.a.num100],show:function(){return 1==e.model.keepAlive},children:[{tag:"template",data:{slot:"append"},children:["次"]}],createFunction:"formItem"},{tag:"el-switch",name:"auth",label:"是否鉴权",default:1,data:{props:{activeValue:1,inactiveValue:0}},createFunction:"formItem"},{tag:"el-switch",name:"adjustTime",label:"是否校时",default:1,data:{props:{activeValue:1,inactiveValue:0}},createFunction:"formItem"},{tag:"el-input",name:"storageId",label:"存储设备国标ID",rules:[v.a.str64],createFunction:"formItem"}]}(this),w.a.gb,this.gbOption,!1)},renderInit:function(){return window.formFactoryRender.bind(this,this.fields,{})},renderGBInit:function(){return window.formFactoryRender.bind(this,this.gbFields,{})}},methods:{getNotRelatedDevices:function(e){var t=this;if(this.encoderHT&&this.encoderHT.clear(),"dv"==this.model.accessType)return this.setChannelNoList(),!1;Service.listNotRelatedDevices(e||{siteId:this.model.siteId,deviceType:this.model.accessType}).then(function(e){e.items.map(function(e){t.encoderHT.register(e.id,e)}),t.option=i()({},t.option,{encoderId:{name:"name",value:"id",list:t.encoderHT.getAll()}}),t.setChannelNoList()})},setChannelNoList:function(){var e=[],t=this.model.encoderId;"dv"==this.model.accessType?(i()(this.model,{channelNo:1}),e=[{id:1,name:1}]):(this.model.id||i()(this.model,{channelNo:""}),e=(t?this.encoderHT.get(t).channels:[]).filter(function(e){return 0==e.used}).map(function(e){return{id:e.channelNo,name:e.channelNo}})),this.option=i()({},this.option,{channelNo:{name:"name",value:"id",list:e}})},open:function(e){var t=this,n=$.modelTpl(this.fields),a=$.modelTpl(this.gbFields);this.model=this.defModel=i()({},n,a,{driverId:[],zoneId:[],recordDriverId:[]}),this.dialog.open(function(){(function(e,t){var n=this;n.encoderHT&&n.encoderHT.clear(),$.initForm({model:e,ajax:[[Service.listZone,{siteId:e.siteId}],[Service.listDriver,{driverType:e.deviceType}],[Service.listDevice4Type,{id:e.id},"put"]],events:[function(e){var t=b("provider","provider",e[1].items||[]),a=[{id:"-1",name:"无",parentId:""}].concat(e[0].items)||[],i=$.db.getConsts();n.setDriverHT(e[1].items),n.option={deviceSubType:{default:"1",name:"name",value:"id",list:i.cameraType||[]},zoneId:{default:"",name:"name",value:"id",list:$.array2tree(a,"id","parentId")||[]},driverId:{default:"",name:"text",value:"virId",list:t},recordDriverId:{default:"",name:"text",value:"virId",list:t},encoderId:{default:"",name:"name",value:"id",list:[]},channelNo:{name:"name",value:"id",list:[{id:1,name:1}]}}},{method:"put",fn:function(e){n.data=e[2].data,n.$nextTick(function(){n.model.encoderId=n.data.encoderId,n.getNotRelatedDevices({siteId:n.data.siteId,deviceType:n.data.accessType})})}},{method:"post",fn:function(t){n.data=e}},function(){$.fire(t,n.data)}]})}).call(t,e,function(n){var a=s()({id:n.id},e),r={};if(a.id){if("gb28181"in n){var o=Util.isEmptyFn(n.gb28181)?{}:JSON.parse(n.gb28181);$.copyValue(r,o,t.gbFields)}$.copyValue(a,n,t.fields);var l=$.createCascadeValue(a.zoneId,t.option.zoneId.list);a.zoneId=Util.isEmptyFn(l[l.length-1])?["-1"]:l,a.driverId=$.createCascadeValue(a.driverId,t.option.driverId.list,"virId"),a.recordDriverId=$.createCascadeValue(a.recordDriverId,t.option.recordDriverId.list,"virId")}else{var d=$.modelTpl(t.fields,t.option),c=$.modelTpl(t.gbFields),u=t.option,m=u.driverId.list,f=u.recordDriverId.list,p=m[0],v=p.port,g=p.username,h=p.password,b=$.createCascadeValue(m[0].id,m,"virId"),I=$.createCascadeValue("",f,"virId");a=i()({},d,c,a,{driverId:b,recordDriverId:I,port:v,username:g,password:h})}t.model=$.extend(!0,{},a,r),t.tab="first",t.dialog.end()})})},saveAjax:function(){var e=this;this.start(function(){var t=i()({},e.getFormValue());$.persist(t,"addDevice","editDevice").then(function(t){e.nvMsg(),e.encoderHT&&e.encoderHT.clear(),e.jtree.init().then(function(){return e.$parent.refreshFn()}),e.close()}).finally(e.end)})}}},A=(n("eU8F"),Object(V.a)(_,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("nv-dialog",{ref:"dialog",staticClass:"camera-dialog tab-dialog",attrs:{title:e.title},on:{close:e.closeEvent}},[n("div",{staticClass:"form-content"},[n("el-tabs",{attrs:{type:"border-card"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[n("el-tab-pane",{attrs:{label:"基础配置",name:"first"}},[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"icon icon-basic"}),e._v(" 基础配置")]),e._v(" "),n("form-factory",{ref:"formFactory",attrs:{init:e.renderInit}})],1),e._v(" "),n("el-tab-pane",{attrs:{label:"国标摄像机",name:"second"}},[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"icon icon-gb"}),e._v(" 国标配置")]),e._v(" "),n("form-factory",{ref:"gbFormFactory",attrs:{init:e.renderGBInit}})],1)],1),e._v(" "),n("div",{staticClass:"btns"},[n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.submit}},[e._v("确定")]),e._v(" "),n("el-button",{attrs:{size:"mini"},on:{click:e.close}},[e._v("取消")])],1)],1)])},[],!1,null,null,null));A.options.__file="dialog.vue";var E=A.exports,N="blur";var k=function(e){return[{tag:"el-input",name:"name",label:"编码器名称",rules:[v.a.required,v.a.str64],createFunction:"formItem"},{tag:"el-input",name:"ip",label:"IP地址",rules:[v.a.required,v.a.ip],createFunction:"formItem"},{tag:"el-input",name:"channelNum",label:"通道数",rules:[v.a.required,v.a.num99999],children:[{tag:"template",data:{slot:"append"},children:["个"]}],createFunction:"formItem"},{tag:"el-cascader",name:"driverId",label:"驱动类型",tip:"添加设备时，此值改变，用户名、密码、端口号会自动填充默认值",change:function(t){if(2==t.length){var n=e.driverHT[t[1]],a=n.port,i=n.username,r=n.password;e.model.port=a,e.model.username=i,e.model.password=r}},rules:[function(e,t,n){return{validator:function(e,n,a){n.some(function(e){return""==e})?a(new Error(t||"此处为必填项")):a()},required:function(){return!0},trigger:n||N}}(),F(e.option.driverId?e.option.driverId.list:[])],createFunction:"formItem"},{tag:"el-input",name:"port",label:"端口号",rules:[v.a.required,v.a.port],createFunction:"formItem"},{tag:"el-input",name:"username",label:"用户名",rules:[v.a.required,v.a.str64],default:"admin",createFunction:"formItem"},{tag:"el-input",name:"password",label:"密码",default:"admin",rules:[v.a.password],createFunction:"formItem"},{tag:"el-cascader",name:"recordDriverId",label:"录像驱动类型",rules:[F(e.option.recordDriverId?e.option.recordDriverId.list:[])],createFunction:"formItem"},{tag:"el-input",name:"deviceParam",type:"textarea",label:"设备参数",rules:[v.a.str1000],createFunction:"formItem"}]},P={name:"EditForm",mixins:[m.a,f,p.a],data:function(){return{isShowGBTab:!0,option:{driverId:[],recordDriverId:[]}}},computed:{fields:function(){return $.formatFinal(k(this),null,this.option,!1)},gbFields:function(){return $.formatFinal(function(e){return[{tag:"el-input",name:"gbId",label:"国标编号",tip:"必填，请输入13或20位长度的数字",rules:[v.a.required,v.a.gbId2],createFunction:"formItem"},{tag:"el-input",name:"gbName",label:"名称",rules:[v.a.str32],createFunction:"formItem"},{tag:"el-input",name:"gbPassword",label:"密码",rules:[v.a.required,v.a.password],createFunction:"formItem"},{tag:"el-switch",name:"keepAlive",label:"是否检测心跳",default:1,data:{props:{activeValue:1,inactiveValue:0}},createFunction:"formItem"},{tag:"el-input",name:"interval",label:"心跳间隔时间",rules:[v.a.num3600],show:function(){return 1==e.model.keepAlive},children:[{tag:"template",data:{slot:"append"},children:["秒"]}],default:"15",createFunction:"formItem"},{tag:"el-input",name:"times",label:"心跳检测次数",rules:[v.a.num100],show:function(){return 1==e.model.keepAlive},children:[{tag:"template",data:{slot:"append"},children:["次"]}],default:"3",createFunction:"formItem"},{tag:"el-switch",name:"auth",label:"是否鉴权",default:1,data:{props:{activeValue:1,inactiveValue:0}},createFunction:"formItem"},{tag:"el-switch",name:"adjustTime",label:"是否校时",default:1,data:{props:{activeValue:1,inactiveValue:0}},createFunction:"formItem"}]}(this),null,this.gbOption,!1)},renderInit:function(){return window.formFactoryRender.bind(this,this.fields,{})},renderGBInit:function(){return window.formFactoryRender.bind(this,this.gbFields,{})}},methods:{setData:function(e,t){var n=this;$.initForm({model:e,ajax:[[Service.listDriver,{driverType:e.deviceType}],[Service.listDevice4Type,{id:e.id},"put"]],events:[function(e){var t=b("provider","provider",e[0].items||[]);n.option={driverId:{name:"text",value:"virId",list:t},recordDriverId:{name:"text",value:"virId",list:[{virId:"",text:"无"}].concat(t)}},n.setDriverHT([{virId:"",text:"无",id:"-1"}].concat(e[0].items))},{method:"put",fn:function(e){n.data=e[1].data}},{method:"post",fn:function(t){n.data=e}},function(){$.fire(t,n.data)}]})},open:function(e){var t=this;this.model=this.defModel=$.extend(!0,$.modelTpl(this.fields),{driverId:[],recordDriverId:[]}),this.dialog.open(function(){t.setData(e,function(n){var a=s()({id:n.id},e),r={},o=t.option,l=o.driverId.list,d=o.recordDriverId.list;if(a.id){if("gb28181"in n){var c=Util.isEmptyFn(n.gb28181)?{}:JSON.parse(n.gb28181);$.copyValue(r,c,t.gbFields)}$.copyValue(a,n,t.fields),a.driverId=$.createCascadeValue(a.driverId,l,"virId"),a.recordDriverId=$.createCascadeValue(a.recordDriverId,d,"virId")}else{var u=l[0],m=u.id,f=u.port,p=u.username,v=u.password;a=i()({},$.modelTpl(t.fields,t.option),s()({driverId:$.createCascadeValue(m,l,"virId"),port:f,username:p,password:v},a))}t.model=$.extend(!0,{},a,r),t.dialog.end()})})}}},j=Object(V.a)(P,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("nv-dialog",{ref:"dialog",staticClass:"tab-dialog",attrs:{title:e.title},on:{close:e.closeEvent}},[n("div",{staticClass:"form-content"},[n("el-tabs",{attrs:{type:"border-card"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[n("el-tab-pane",{attrs:{label:"基础配置",name:"first"}},[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"icon icon-basic"}),e._v(" 基础配置")]),e._v(" "),n("form-factory",{ref:"formFactory",attrs:{init:e.renderInit}})],1),e._v(" "),n("el-tab-pane",{attrs:{label:"国标配置",name:"second"}},[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"icon icon-gb"}),e._v(" 国标配置")]),e._v(" "),n("form-factory",{ref:"gbFormFactory",attrs:{init:e.renderGBInit}})],1)],1),e._v(" "),n("div",{staticClass:"btns"},[n("el-button",{attrs:{loading:e.loading,size:"mini",type:"primary"},on:{click:e.submit}},[e._v("确定")]),e._v(" "),n("el-button",{attrs:{size:"mini"},on:{click:e.close}},[e._v("取消")])],1)],1)])},[],!1,null,null,null);j.options.__file="dialog.vue";var q=j.exports,z={name:"EditForm",mixins:[m.a,f,p.a],data:function(){return{isShowGBTab:!0,option:{driverId:[]}}},computed:{fields:function(){return $.formatFinal(function(e){return[{tag:"el-input",name:"name",label:"解码器名称",rules:[v.a.required],createFunction:"formItem"},{tag:"el-input",name:"ip",label:"IP地址",rules:[v.a.required,v.a.ip],createFunction:"formItem"},{tag:"el-cascader",name:"driverId",label:"驱动类型",tip:"添加设备时，此值改变，用户名、密码、端口号会自动填充默认值",change:function(t){if(2==t.length){var n=e.driverHT[t[1]],a=n.port,i=n.username,r=n.password;e.model.port=a,e.model.username=i,e.model.password=r}},rules:[v.a.required,F(e.option.driverId?e.option.driverId.list:[])],createFunction:"formItem"},{tag:"el-input",name:"port",label:"端口号",tip:"必填项，请输入1 ~ 65535范围内的整数",rules:[v.a.required,v.a.port],createFunction:"formItem"},{tag:"el-input",name:"username",label:"用户名",rules:[v.a.required,v.a.str64],createFunction:"formItem"},{tag:"el-input",name:"password",label:"密码",rules:[v.a.password],createFunction:"formItem"},{tag:"el-input",name:"channelNum",label:"通道数",rules:[v.a.required,v.a.num99999],children:[{tag:"template",data:{slot:"append"},children:["个"]}],createFunction:"formItem"},{tag:"el-input",name:"maxWindow",label:"单通道最大画面数",default:"1",rules:[v.a.required,v.a.num99],createFunction:"formItem"},{tag:"el-input",type:"textarea",name:"deviceParam",label:"设备参数",rules:[v.a.str1000],createFunction:"formItem"}]}(this),null,this.option,!1)},gbFields:function(){return $.formatFinal(function(e){return[{tag:"el-input",name:"gbId",label:"国标编号",tip:"必填，请输入13或20位长度的数字",rules:[v.a.required,v.a.gbId2],createFunction:"formItem"},{tag:"el-input",name:"gbName",label:"名称",rules:[v.a.str64],createFunction:"formItem"},{tag:"el-input",name:"gbPassword",label:"密码",rules:[v.a.required,v.a.password],createFunction:"formItem"},{tag:"el-switch",name:"keepAlive",label:"是否检测心跳",default:1,data:{props:{activeValue:1,inactiveValue:0}},createFunction:"formItem"},{tag:"el-input",name:"interval",label:"心跳间隔时间",default:"15",rules:[v.a.num3600],show:function(){return 1==e.model.keepAlive},children:[{tag:"template",data:{slot:"append"},children:["秒"]}],createFunction:"formItem"},{tag:"el-input",name:"times",label:"心跳检测次数",default:"3",rules:[v.a.num100],show:function(){return 1==e.model.keepAlive},children:[{tag:"template",data:{slot:"append"},children:["次"]}],createFunction:"formItem"},{tag:"el-switch",name:"auth",label:"是否鉴权",default:1,data:{props:{activeValue:1,inactiveValue:0}},createFunction:"formItem"},{tag:"el-switch",name:"adjustTime",label:"是否校时",default:1,data:{props:{activeValue:1,inactiveValue:0}},createFunction:"formItem"}]}(this),null,this.gbOption,!1)},renderInit:function(){return window.formFactoryRender.bind(this,this.fields,{})},renderGBInit:function(){return window.formFactoryRender.bind(this,this.gbFields,{})}},methods:{setData:function(e,t){var n=this;$.initForm({model:e,ajax:[[Service.listDriver,{driverType:e.deviceType}],[Service.listDevice4Type,{id:e.id},"put"]],events:[function(e){var t=e[0].items||[];n.option={driverId:{name:"text",value:"virId",list:b("provider","provider",t)}},n.setDriverHT(e[0].items)},{method:"put",fn:function(e){n.data=e[1].data}},{method:"post",fn:function(t){n.data=e}},function(){$.fire(t,n.data)}]})},open:function(e){var t=this;this.model=this.defModel=$.extend(!0,$.modelTpl(this.fields),{driverId:[]}),this.dialog.open(function(){t.setData(e,function(n){var a=s()({id:n.id},e),r={},o=t.option.driverId.list;if(a.id){if("gb28181"in n){var l=Util.isEmptyFn(n.gb28181)?{}:JSON.parse(n.gb28181);$.copyValue(r,l,t.gbFields)}$.copyValue(a,n,t.fields),a.driverId=$.createCascadeValue(a.driverId,o,"virId")}else{var d=o[0],c=d.id,u=d.port,m=d.username,f=d.password;a=i()({},$.modelTpl(t.fields,t.option),s()({driverId:$.createCascadeValue(c,o,"virId"),port:u,username:m,password:f},a))}t.model=$.extend(!0,{},a,r),t.dialog.end()})})}}},R=Object(V.a)(z,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("nv-dialog",{ref:"dialog",staticClass:"tab-dialog",attrs:{title:e.title},on:{close:e.closeEvent}},[n("div",{staticClass:"form-content"},[n("el-tabs",{attrs:{type:"border-card"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[n("el-tab-pane",{attrs:{label:"基础配置",name:"first"}},[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"icon icon-basic"}),e._v(" 基础配置")]),e._v(" "),n("form-factory",{ref:"formFactory",attrs:{init:e.renderInit}})],1),e._v(" "),n("el-tab-pane",{attrs:{label:"国标配置",name:"second"}},[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"icon icon-gb"}),e._v(" 国标配置")]),e._v(" "),n("form-factory",{ref:"gbFormFactory",attrs:{init:e.renderGBInit}})],1)],1),e._v(" "),n("div",{staticClass:"btns"},[n("el-button",{attrs:{loading:e.loading,size:"mini",type:"primary"},on:{click:e.submit}},[e._v("确定")]),e._v(" "),n("el-button",{attrs:{size:"mini"},on:{click:e.close}},[e._v("取消")])],1)],1)])},[],!1,null,null,null);R.options.__file="dialog.vue";var B=R.exports,G={name:"EditForm",mixins:[m.a,f],data:function(){return{model:{},option:{driverId:[]}}},computed:{fields:function(){return $.formatFinal(function(e){return[{tag:"el-input",name:"name",label:"键盘名称",tip:"必填项，1 ~ 64 个字符，支持中文、英文（大小写）、整数输入",rules:[v.a.required,v.a.str64],createFunction:"formItem"},{tag:"el-input",name:"ip",label:"IP地址",rules:[v.a.required,v.a.ip],createFunction:"formItem"},{tag:"el-cascader",name:"driverId",label:"驱动类型",tip:"添加设备时，此值改变，用户名、密码、端口号会自动填充默认值",change:function(t){if(2==t.length){var n=e.driverHT[t[1]],a=n.port,i=n.username,r=n.password;e.model.port=a,e.model.username=i,e.model.password=r}},rules:[v.a.required,F(e.option.driverId?e.option.driverId.list:[])],createFunction:"formItem"},{tag:"el-input",name:"port",label:"端口号",tip:"必填项，请输入1 ~ 65535范围内的整数",rules:[v.a.required,v.a.port],createFunction:"formItem"},{tag:"el-input",name:"username",label:"用户名",rules:[v.a.required,v.a.str64],default:"admin",createFunction:"formItem"},{tag:"el-input",name:"password",label:"密码",default:"admin",rules:[v.a.password],createFunction:"formItem"},{tag:"el-input",type:"textarea",name:"deviceParam",label:"设备参数",rules:[v.a.str1000],createFunction:"formItem"}]}(this),null,this.option,!1)}},methods:{setData:function(e,t){var n=this;$.initForm({model:e,ajax:[[Service.listDriver,{driverType:e.deviceType}],[Service.listDevice4Type,{id:e.id},"put"]],events:[function(e){var t=e[0].items;n.option={driverId:{name:"text",value:"virId",list:b("provider","provider",t||[])}},n.setDriverHT(e[0].items)},{method:"put",fn:function(e){n.data=e[1].data}},{method:"post",fn:function(t){n.data=e}},function(){$.fire(t,n.data)}]})},open:function(e){var t=this;this.model=this.defModel=$.extend(!0,{},$.modelTpl(this.fields,this.option,{driverId:[]})),this.dialog.open(function(){t.setData(e,function(e){var n={id:e.id},a=t.option.driverId.list;if(n.id)$.copyValue(n,e,t.fields),n.driverId=$.createCascadeValue(n.driverId,a,"virId");else{var r=a[0],o=r.id,l=r.port,d=r.username,c=r.password;n=i()({},$.modelTpl(t.fields,t.option),s()({driverId:$.createCascadeValue(o,a,"virId"),port:l,username:d,password:c},n))}t.model=$.extend(!0,{},n),t.dialog.end()})})}}},O=Object(V.a)(G,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("nv-dialog",{ref:"dialog",staticClass:"device-dialog",attrs:{title:e.title}},[n("div",{staticClass:"form-content"},[n("form-factory",{ref:"formFactory",attrs:{init:e.renderInit}},[n("el-form-item",[n("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.submit}},[e._v("确定")]),e._v(" "),n("el-button",{on:{click:e.close}},[e._v("取消")])],1)],1)],1)])},[],!1,null,null,null);O.options.__file="dialog.vue";var H={name:"DeviceList",components:{ServerForm:x,CameraForm:E,EncoderForm:q,DecoderForm:B,KeyboardForm:O.exports},mixins:[r.a],data:function(){this.$createElement;var e=this;return{title:"",prevNodeKey:null,filter:{siteId:"",deviceType:"",deviceSubType:"",selectParam:""},treeSetting:{nodeKey:"key",props:{children:"children",label:"name"},initNodeFn:function(t){var n=e.prevNodeKey?[e.prevNodeKey]:[t[0][this.nodeKey]];e.jtree.curNodeKeys=n,e.jtree.setCurrentNode(n[0])},ajax:{init:function(){return Service.listDeviceCount().then(function(e){return g(e.items)})}},nodeClickFn:function(t,n){e.prevNodeKey=t.key,e.jtable.clear(function(){return e.refreshFn(t)})},renderFn:function(e,t){var n=t.node,a=t.data,i=this.$createElement;return i("div",{class:{node:!0,"data-key":n.data.id,"data-type":a.nodeType}},[i("span",{class:["icon","icon-"+n.data.icon]}),i("span",[n.label]),i("span",{class:"count"},["site"==a.nodeType?"":"（"+a.count+"）"])])}},gridConfig:{clz:"device-grid",selectable:!0,pagination:!0,actions:[{name:"refresh",icon:"icon icon-refresh",title:"刷新",handleFn:function(t){e.refreshFn()}},{name:"create",icon:"el-icon-edit-outline",title:"添加",disabledFn:function(){var t=e.jtree.getActive();return!!t&&"site"==t.nodeType},handleFn:function(t){e.title="添加"+e.getDialogTitle(),h.call(e)}},{name:"batchDel",icon:"el-icon-delete",title:"批量删除",handleFn:function(){e.delFn()}}],listenerWidth:"140px",listeners:[{name:"edit",icon:"icon icon-release",title:"释放云台",showFn:function(e){var t=e.deviceType,n=e.deviceSubType;return"Camera"==t&&1==n},handleFn:function(t){var n=t.id;Service.releasePTZ({id:n}).then(function(t){return e.$message.success("操作成功")})}},{name:"edit",icon:"icon icon-sync",title:"同步",showFn:function(e){var t=e.deviceType,n=e.deviceSubType;return"Server"==t&&"VideoPlatform"==n},handleFn:function(t){var n=t.id;Service.syncCameraInfo({id:n}).then(function(t){return e.$message.success("操作成功")})}},{name:"edit",icon:"el-icon-edit",title:"编辑",handleFn:function(t){e.title="编辑"+e.getDialogTitle(),h.call(e,t)}},{name:"delete",icon:"el-icon-delete",title:"删除",handleFn:function(t){e.delFn(t)}}],column:l("default"),ajax:{init:function(t){var n=i()({},t,e.filter);return Service.listDevice4Type(n).then(function(e){return e})}}}}},computed:{jtree:function(){return this.$refs.jtree},jtable:function(){return this.$refs.jtable},dialog:function(){return this.$refs.dialog}},mounted:function(){var e=this;this.jtree.init().then(function(t){return e.refreshFn()})},methods:{clearFilter:function(){this.filter.selectParam=""},getDialogTitle:function(){var e=String(this.jtree.getActive().key).split("-");return $.v2str("deviceType",e[1])},refreshFn:function(){var e=String(this.jtree.getActive().key).split("-");i()(this.filter,{siteId:e[0],deviceType:e[1]||"",deviceSubType:e[2]||""}),this.jtable.setColumn(l(e[1]||"default")),this.jtable.init()},delFn:function(e){var t=this,n=[e];if(!e&&!(n=this.jtable.getChecked()).length)return this.$message.warning("请至少选择一条信息");this.$confirm("确认要删除这些设备吗？","提示",{type:"warning"}).then(function(){Service.delDevice({ids:n.map(function(e){return e.id})}).then(function(e){t.$message.success("操作成功"),t.jtree.init().then(function(e){return t.refreshFn()})})},function(){return t.$message.warning("操作取消")})}}},U=(n("WLbQ"),Object(V.a)(H,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"page-device clearfix"},[n("div",{staticClass:"device-tree fl"},[n("nv-tree",{ref:"jtree",attrs:{setting:e.treeSetting}})],1),e._v(" "),n("div",{staticClass:"device-list fl"},[n("nv-table",{ref:"jtable",attrs:{setting:e.gridConfig}},[n("div",{attrs:{slot:"filter"},slot:"filter"},[n("el-input",{attrs:{placeholder:"请输入查询条件"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.refreshFn(t):null}},model:{value:e.filter.selectParam,callback:function(t){e.$set(e.filter,"selectParam",t)},expression:"filter.selectParam"}},[n("el-tooltip",{attrs:{slot:"prefix",content:"检索范围：设备IP、设备名称",effect:"light",placement:"top-end"},slot:"prefix"},[n("i",{staticClass:"icon icon-qs"})]),e._v(" "),n("i",{staticClass:"el-input__icon el-icon-close",attrs:{slot:"suffix"},on:{click:e.clearFilter},slot:"suffix"}),e._v(" "),n("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.refreshFn},slot:"append"})],1)],1)])],1),e._v(" "),n("server-form",{ref:"ServerForm",attrs:{title:e.title}}),e._v(" "),n("camera-form",{ref:"CameraForm",attrs:{title:e.title}}),e._v(" "),n("encoder-form",{ref:"EncoderForm",attrs:{title:e.title}}),e._v(" "),n("decoder-form",{ref:"DecoderForm",attrs:{title:e.title}}),e._v(" "),n("keyboard-form",{ref:"KeyboardForm",attrs:{title:e.title}})],1)},[],!1,null,null,null));U.options.__file="index.vue";t.default=U.exports},WLbQ:function(e,t,n){"use strict";var a=n("HpZk");n.n(a).a},eU8F:function(e,t,n){"use strict";var a=n("nc/C");n.n(a).a},kKWf:function(e,t,n){"use strict";var a=n("Gd76"),i=n.n(a);t.a={data:function(){return{downLoading:!1}},methods:{timeRangeChangeFn:function(){var e=this.filter.timeRange,t=[$.getCurDay().from,$.getCurDay().to];return $.isEmptyFn(e)?this.filter.timeRange=["",""]:this.filter.timeRange.every(function(e){return 0==e})?this.filter.timeRange=t:this.filter.timeRange=this.filter.timeRange.map(function(e){return e instanceof Date?$.Date.getTickInSec(e):e})},clearFilter:function(e,t){for(var n in this.filter)this.filter[n]="timeRange"==n?[$.getCurDay().from,$.getCurDay().to]:e&&e[n]||"";t&&t()},query:function(){var e=this;this.jtable.clear(function(){e.jtable.init()})},download:function(e,t){var n=this;this.downLoading=!0,Service[e](t||this.filter).then(function(e){n.downLoading=!1;var t=e.headers["content-disposition"],a=decodeURI(t.match(/filename=(.*)/)[1],"UTF-8");i()(e.data,a)})}}}},"nc/C":function(e,t,n){},uV9B:function(e,t,n){"use strict";var a=n("gDS+"),i=n.n(a),r=n("4d7F"),o=n.n(r);t.a={data:function(){return{tab:"first",gbOption:{}}},methods:{getFirstForm:function(){return this.$refs.formFactory.$refs.form},getSecondForm:function(){return this.$refs.gbFormFactory.$refs.form},validateFirst:function(e,t,n){var a=this;return new o.a(function(e,t){a.getFirstForm().validateTabForm(function(t,n){e(t)},n)})},validateSecond:function(e,t,n){var a=this;return new o.a(function(e,t){a.getSecondForm().validate(function(t,n){e(t)},!1)})},getSecondFormValue:function(e){var t=this,n={};return this.gbFields.forEach(function(e){if(e.name&&(!e.show||e.show())){var a=t.model[e.name];n[e.name]=a}}),{gb28181:i()(n)}},submit:function(e){var t=this;"first"==this.tab?o.a.all([this.validateFirst()]).then(function(e){e[0]&&t.saveAjax()}):o.a.all([this.validateFirst(),this.validateSecond()]).then(function(e){return e[0]||e[1]?e[0]?e[1]?void(e[0]&&e[1]&&t.saveAjax()):t.nvMsg("请确认国标配置","warning"):t.nvMsg("请确认基础配置","warning"):t.nvMsg("请确认基础配置、国标配置","warning")})},closeEvent:function(){this.tab="first"}}}}}]);